{"version":3,"sources":["demo/Demo07.js"],"names":["Demo02","ref","useRef","useEffect","canvas","current","gl","getWebGLContext","initShaders","Error","a_Position","getAttribLocation","program","u_rotateZMatrix","getUniformLocation","u_translateMatrix","u_scaleMatrix","vertexList","createVertexList","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","clearColor","subject","SpringSubject","rotate$","pipe","map","n","createRotateZMatrix","translate$","x","createTranslateMatrix","scale$","scale","createScaleMatrix","combineLatest","subscribe","_ref","_ref2","Object","D_Users_yj_gu_Documents_code_GitHub_learn_webgl_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","value","rotate","translate","clear","COLOR_BUFFER_BIT","uniformMatrix4fv","drawArrays","TRIANGLE_STRIP","next","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","width","height"],"mappings":"0MAYe,SAASA,IACtB,IAAIC,EAAMC,mBAyEV,OAvEAC,oBAAU,WACR,IAAIC,EAASH,EAAII,QACbC,EAAKC,YAAgBH,GAqBzB,IAFgBI,YAAYF,EAjBV,8SAWA,0FAShB,MAAM,IAAIG,MAAM,+BAGlB,IAAIC,EAAaJ,EAAGK,kBAAkBL,EAAGM,QAAS,cAC9CC,EAAkBP,EAAGQ,mBAAmBR,EAAGM,QAAS,mBACpDG,EAAoBT,EAAGQ,mBACzBR,EAAGM,QACH,qBAEEI,EAAgBV,EAAGQ,mBAAmBR,EAAGM,QAAS,iBAElDK,EAAaC,YAAiB,CAAC,CAAC,EAAK,IAAM,EAAE,IAAM,IAAM,CAAC,IAAM,MAEhEC,EAASb,EAAGc,eAEhBd,EAAGe,WAAWf,EAAGgB,aAAcH,GAC/Bb,EAAGiB,WAAWjB,EAAGgB,aAAcL,EAAYX,EAAGkB,aAE9ClB,EAAGmB,oBAAoBf,EAAY,EAAGJ,EAAGoB,OAAO,EAAO,EAAG,GAC1DpB,EAAGqB,wBAAwBjB,GAE3BJ,EAAGsB,WAAW,EAAG,EAAG,EAAG,GAEvB,IAAIC,EAAUC,YAAc,EAAG,GAC3BC,EAAUF,EAAQG,KACpBC,YAAI,SAAAC,GAAC,OAAIC,YAAwB,IAAJD,MAE3BE,EAAaP,EAAQG,KACvBC,YAAI,SAAAI,GAAC,OAAIC,YAAsBD,EAAI,MAEjCE,EAASV,EAAQG,KACnBC,YAAI,SAAAO,GAAK,OAAIC,YAAkBD,EAAOA,EAAOA,MAEnCE,YAAc,CAACb,EAASE,EAASK,EAAYG,IAEnDI,UAAU,SAAAC,GAAuC,IAAAC,EAAAC,OAAAC,EAAA,EAAAD,CAAAF,EAAA,GAArCI,EAAqCH,EAAA,GAA9BI,EAA8BJ,EAAA,GAAtBK,EAAsBL,EAAA,GAAXL,EAAWK,EAAA,GACrDvC,EAAG6C,MAAM7C,EAAG8C,kBACZ9C,EAAG+C,iBAAiBxC,GAAiB,EAAOoC,GAC5C3C,EAAG+C,iBAAiBtC,GAAmB,EAAOmC,GAC9C5C,EAAG+C,iBAAiBrC,GAAe,EAAOwB,GAC1ClC,EAAGgD,WAAWhD,EAAGiD,eAAgB,EAAG,GAEtB,IAAVP,GAAanB,EAAQ2B,KAAK,GAChB,IAAVR,GAAanB,EAAQ2B,KAAK,MAE/B,IAEIC,EAAAC,EAAAC,cAAA,UAAQC,MAAO,IAAKC,OAAQ,IAAK5D,IAAKA","file":"static/js/17.70181dc7.chunk.js","sourcesContent":["import React, { useEffect, useRef } from 'react'\r\nimport { getWebGLContext, initShaders } from '../lib/cuon-utils'\r\nimport {\r\n  createVertexList,\r\n  createRotateZMatrix,\r\n  createScaleMatrix,\r\n  createTranslateMatrix\r\n} from './util'\r\nimport { combineLatest, concat } from 'rxjs'\r\nimport { map, take, tap, mapTo } from 'rxjs/operators'\r\nimport { Spring, SpringSubject } from '../spring'\r\n\r\nexport default function Demo02() {\r\n  let ref = useRef()\r\n\r\n  useEffect(() => {\r\n    let canvas = ref.current\r\n    let gl = getWebGLContext(canvas)\r\n\r\n    let VSHADER_SOURCE = `\r\n      attribute vec4 a_Position;\r\n      uniform mat4 u_rotateZMatrix;\r\n      uniform mat4 u_translateMatrix;\r\n      uniform mat4 u_scaleMatrix;\r\n      void main() {\r\n        gl_Position = u_rotateZMatrix * u_translateMatrix * u_scaleMatrix * a_Position;\r\n        gl_PointSize = 3.0;\r\n      }\r\n    `\r\n\r\n    let FSHADER_SOURCE = `\r\n      void main() {\r\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\r\n      }\r\n    `\r\n\r\n    let isSuccess = initShaders(gl, VSHADER_SOURCE, FSHADER_SOURCE)\r\n\r\n    if (!isSuccess) {\r\n      throw new Error('failed to initilize shaders')\r\n    }\r\n\r\n    let a_Position = gl.getAttribLocation(gl.program, 'a_Position')\r\n    let u_rotateZMatrix = gl.getUniformLocation(gl.program, 'u_rotateZMatrix')\r\n    let u_translateMatrix = gl.getUniformLocation(\r\n      gl.program,\r\n      'u_translateMatrix'\r\n    )\r\n    let u_scaleMatrix = gl.getUniformLocation(gl.program, 'u_scaleMatrix')\r\n\r\n    let vertexList = createVertexList([[0.0, 0.5], [-0.5, -0.5], [0.5, -0.5]])\r\n\r\n    let buffer = gl.createBuffer()\r\n\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\r\n    gl.bufferData(gl.ARRAY_BUFFER, vertexList, gl.STATIC_DRAW)\r\n\r\n    gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 0, 0)\r\n    gl.enableVertexAttribArray(a_Position)\r\n\r\n    gl.clearColor(0, 0, 0, 1)\r\n\r\n    let subject = SpringSubject(1, 1)\r\n    let rotate$ = subject.pipe(\r\n      map(n => createRotateZMatrix(n * 360))\r\n    )\r\n    let translate$ = subject.pipe(\r\n      map(x => createTranslateMatrix(x / 2))\r\n    )\r\n    let scale$ = subject.pipe(\r\n      map(scale => createScaleMatrix(scale, scale, scale))\r\n    )\r\n    let data$ = combineLatest([subject, rotate$, translate$, scale$])\r\n\r\n    data$.subscribe(([value, rotate, translate, scale]) => {\r\n      gl.clear(gl.COLOR_BUFFER_BIT)\r\n      gl.uniformMatrix4fv(u_rotateZMatrix, false, rotate)\r\n      gl.uniformMatrix4fv(u_translateMatrix, false, translate)\r\n      gl.uniformMatrix4fv(u_scaleMatrix, false, scale)\r\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 3)\r\n\r\n      if (value === 0) subject.next(1)\r\n      if (value === 1) subject.next(0)\r\n    })\r\n  }, [])\r\n\r\n  return <canvas width={400} height={400} ref={ref} />\r\n}"],"sourceRoot":""}
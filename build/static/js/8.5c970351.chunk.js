(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{28:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return r})},29:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",function(){return a})},57:function(t,e,n){var r=n(24).vec3,a=function(t){return t instanceof Float32Array},i=function(t){return r.fromValues(t,t,t)};t.exports={_add_:function(t,e){return a(t)||a(e)?(a(t)||(t=i(t)),a(e)||(e=i(e)),r.add(r.create(),t,e)):t+e},_sub_:function(t,e){return a(t)||a(e)?(a(t)||(t=i(t)),a(e)||(e=i(e)),r.sub(r.create(),t,e)):t-e},_mul_:function(t,e){return a(t)||a(e)?(a(t)||(t=i(t)),a(e)||(e=i(e)),r.mul(r.create(),t,e)):t*e},_div_:function(t,e){return a(t)||a(e)?(a(t)||(t=i(t)),a(e)||(e=i(e)),r.div(r.create(),t,e)):t/e},_negate_:function(t){return a(t)?r.negate(r.create(),t):-t}}},75:function(t,e,n){"use strict";n.r(e);var r=n(17),a=n.n(r),i=n(19),o=n(1),u=n(0),c=n.n(u),s=n(28),f=n(29),h=n(24).vec3,d=n(57),l=d._add_,v=d._sub_,b=d._mul_,m=d._div_,w=d._negate_,p=function(t,e,n){return h.fromValues(t,e,n)},x=function(t,e){return h.dot(t,e)},k=function(t,e){return h.cross(h.create(),t,e)},g=function(t){return h.normalize(h.create(),t)},M=function(){function t(e,n){Object(s.a)(this,t),this.a=e,this.b=n}return Object(f.a)(t,[{key:"origin",value:function(){return this.a}},{key:"direction",value:function(){return this.b}},{key:"pointAt",value:function(t){var e=this.a,n=this.b;return l(e,b(t,n))}}]),t}(),y=function(){return{t:0,p:h.create(),normal:h.create()}},j=function(){function t(e,n,r){Object(s.a)(this,t),this.center=e,this.radius=n,this.material=r}return Object(f.a)(t,[{key:"hit",value:function(t,e,n,r){var a=v(t.origin(),this.center),i=x(t.direction(),t.direction()),o=x(a,t.direction()),u=v(x(a,a),b(this.radius,this.radius)),c=v(b(o,o),b(i,u));if(c<0)return!1;var s=m(v(w(o),Math.sqrt(c)),i),f=s<n&&s>e;return f||(f=(s=m(l(w(o),Math.sqrt(c)),i))<n&&s>e),!!f&&(r.t=s,r.p=t.pointAt(s),r.normal=m(v(r.p,this.center),this.radius),r.material=this.material,!0)}}]),t}(),O=function(){function t(e){Object(s.a)(this,t),this.list=e}return Object(f.a)(t,[{key:"hit",value:function(t,e,n,r){var a=y(),i=!1,o=n,u=!0,c=!1,s=void 0;try{for(var f,h=this.list[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){f.value.hit(t,e,o,a)&&(i=!0,o=a.t,Object.assign(r,a))}}catch(d){c=!0,s=d}finally{try{u||null==h.return||h.return()}finally{if(c)throw s}}return i}},{key:"push",value:function(){var t;(t=this.list).push.apply(t,arguments)}}]),t}(),_=function(){function t(e,n,r,a,i,o,u){Object(s.a)(this,t);var c=m(b(a,Math.PI),180),f=Math.tan(m(c,2)),h=b(f,i),d=e,w=g(v(e,n)),p=g(k(r,w)),x=k(w,p),M=v(d,b(u,l(l(b(p,h),b(x,f)),w))),y=b(b(b(u,2),p),h),j=b(b(b(u,2),x),f);this.u=p,this.v=x,this.origin=d,this.lowerLeftCorner=M,this.horizontal=y,this.vertical=j,this.lensRadius=m(o,2)}return Object(f.a)(t,[{key:"getRay",value:function(t,e){var n=this.origin,r=this.lowerLeftCorner,a=this.horizontal,i=this.vertical,o=b(this.lensRadius,function(){var t;do{var e=p(Math.random(),Math.random(),0);t=v(b(2,e),p(1,1,0))}while(x(t,t)>=1);return t}()),u=l(b(this.u,o[0]),b(this.v,o[1])),c=v(l(l(r,b(t,a)),b(e,i)),n);return new M(l(n,u),v(c,u))}}]),t}(),D=function(){var t;do{var e=p(Math.random(),Math.random(),Math.random());t=v(b(2,e),p(1,1,1))}while(h.squaredLength(t)>=1);return t},A=function(){function t(e){Object(s.a)(this,t),this.albedo=e}return Object(f.a)(t,[{key:"scatter",value:function(t,e,n){var r=l(l(e.p,e.normal),D()),a=v(r,e.p);return n.scattered=new M(e.p,a),n.attenuation=this.albedo,!0}}]),t}(),F=function(t,e){return v(t,b(b(2,x(t,e)),e))},z=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(s.a)(this,t),this.albedo=e,this.fuzz=Math.min(n,1)}return Object(f.a)(t,[{key:"scatter",value:function(t,e,n){var r=F(h.normalize(h.create(),t.direction()),e.normal);return n.scattered=new M(e.p,l(r,b(this.fuzz,D()))),n.attenuation=this.albedo,x(n.scattered.direction(),e.normal)>0}}]),t}(),I=function(){function t(e){Object(s.a)(this,t),this.refractIndex=e}return Object(f.a)(t,[{key:"scatter",value:function(t,e,n){var r=h.create(),a=F(t.direction(),e.normal),i=0,o=0;n.attenuation=p(1,1,1);var u=x(t.direction(),e.normal);u>0?(r=w(e.normal),i=this.refractIndex,o=m(b(this.refractIndex,u),h.length(t.direction()))):(r=e.normal,i=m(1,this.refractIndex),o=m(w(u),h.length(t.direction())));var c=0;return c=function(t,e,n,r){var a=h.normalize(h.create(),t),i=x(a,e),o=v(1,b(b(n,n),v(1,b(i,i))));return o>0&&(r.refracted=v(b(n,v(a,b(e,i))),b(e,Math.sqrt(o))),!0)}(t.direction(),r,i,n)?function(t,e){var n=m(v(1,e),l(1,e));return n=b(n,n),l(n,b(v(1,n),Math.pow(v(1,t),5)))}(o,this.refractIndex):1,Math.random()<c?n.scattered=new M(e.p,a):n.scattered=new M(e.p,n.refracted),!0}}]),t}(),q=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=y();if(n.hit(e,.001,1/0,a)){var i={scattered:null,attenuation:0};return r>=50||!a.material.scatter(e,a,i)?p(0,0,0):b(i.attenuation,t(i.scattered,n,l(r,1)))}var o,u,c,s=h.normalize(h.create(),e.direction());return o=b(.5,l(s[1],1)),u=p(1,1,1),c=p(.5,.7,1),l(b(v(1,o),u),b(o,c))},R=function(t){var e=t.width,n=void 0===e?800:e,r=t.height,i=void 0===r?400:r,u=t.amount,c=void 0===u?2:u,s=t.lookFrom,f=void 0===s?p(13,2,3):s,d=t.lookAt,x=void 0===d?p(0,0,0):d,k=t.vup,g=void 0===k?p(0,1,0):k,M=t.vfov,y=void 0===M?20:M,D=t.aspect,F=void 0===D?m(n,i):D,R=t.focusDist,E=void 0===R?10:R,C=t.aperture,P=n,L=i,S=new _(f,x,g,y,F,void 0===C?.1:C,E),B=function(t){var e=[],n=Math.floor(m(Math.sqrt(t),2)),r=w(n),a=+n;e[0]=new j(p(0,-1e3,0),1e3,new A(p(.5,.5,.5)));for(var i=1,o=p(4,.2,0),u=r;u<a;u++)for(var c=r;c<a;c++){var s=Math.random(),f=p(l(u,b(.9,Math.random())),.2,l(c,b(.9,Math.random())));if(h.length(v(f,o))>.9)if(s<.8){var d=new A(p(b(Math.random(),Math.random()),b(Math.random(),Math.random()),b(Math.random(),Math.random())));e[i++]=new j(f,.2,d)}else if(s<.95){var x=new z(p(b(.5,l(1,Math.random())),b(.5,l(1,Math.random())),b(.5,l(1,Math.random()))),b(.5,Math.random()));e[i++]=new j(f,.2,x)}else e[i++]=new j(f,.2,new I(1.5))}return e[i++]=new j(p(0,1,0),1,new I(1.5)),e[i++]=new j(p(-4,1,0),1,new A(p(.4,.2,.1))),e[i++]=new j(p(4,1,0),1,new z(p(.7,.6,.5),0)),new O(e)}(c),J=function(t,e){var n=m(l(t,Math.random()),P),r=m(l(e,Math.random()),L),a=S.getRay(n,r);return q(a,B)};return{render:a.a.mark(function t(){var e,n,r,i,u,c,s,f;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=v(L,1);case 1:if(!(e>=0)){t.next=20;break}n=0;case 3:if(!(n<P)){t.next=17;break}return r=J(n,e),i=Object(o.a)(r,3),u=i[0],c=i[1],s=i[2],f=1,t.next=8,u;case 8:return t.next=10,c;case 10:return t.next=12,s;case 12:return t.next=14,f;case 14:n++,t.next=3;break;case 17:e--,t.next=1;break;case 20:case"end":return t.stop()}},t)}),renderByPosition:J}};n.d(e,"default",function(){return B});var E=function(){},C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;return new Promise(function(e){requestAnimationFrame(function(){t(),e()})})},P=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n/t.length},L=function(t,e){for(var n=[],r=0;r<t.length;r+=4){var a=Math.floor(r/4),i=[t[r+0],t[r+1],t[r+2],t[r+3]],o=[e[r+0],e[r+1],e[r+2],e[r+3]];n[a]={index:a,value:P(i,o)}}return n.sort(function(t,e){return e.value-t.value})},S=function(t){return Math.floor(255.99*Math.sqrt(t))};function B(){var t=Object(u.useState)(0),e=Object(o.a)(t,2),n=e[0],r=e[1],s=Object(u.useRef)(),f=Object(u.useRef)();return Object(u.useEffect)(function(){var t=s.current,e=f.current,n=t.getContext("2d"),u=R({width:800,height:400,amount:50}),c=n.createImageData(800,400),h=new Float32Array(128e4),d=new Float32Array(128e4),l=new Float32Array(128e4),v=new Float32Array(128e4),b=1,m=0,w=null,p=!1,x=function(){n.fillColor="rgba(0, 0, 0, 1)",n.clearRect(0,0,800,400),n.putImageData(c,0,0)},k=function(){for(var t=v,n=e.getContext("2d"),r=n.createImageData(800,400),a=0;a<t.length;a++)r.data[a]=(a+1)%4===0?255:t[a];n.clearRect(0,0,800,400),n.putImageData(r,0,0)},g=function(t,e){var n=u.renderByPosition(t,e),r=Object(o.a)(n,4),a=r[0],i=r[1],s=r[2],f=r[3],b=void 0===f?1:f,m=4*(800*(400-e)+t);h[m+0]+=a,h[m+1]+=i,h[m+2]+=s,h[m+3]+=b,v[m+0]+=1,v[m+1]+=1,v[m+2]+=1,v[m+3]+=1,d[m+0]=c.data[m+0],d[m+1]=c.data[m+1],d[m+2]=c.data[m+2],d[m+3]=c.data[m+3],c.data[m+0]=S(h[m+0]/v[m+0]),c.data[m+1]=S(h[m+1]/v[m+1]),c.data[m+2]=S(h[m+2]/v[m+2]),c.data[m+3]=S(h[m+3]/v[m+3]),l[m+0]=c.data[m+0],l[m+1]=c.data[m+1],l[m+2]=c.data[m+2],l[m+3]=c.data[m+3]},M=function(){var t=Object(i.a)(a.a.mark(function t(){var e,n,i,o,u,c=arguments;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=c.length>0&&void 0!==c[0]?c[0]:4,n=Date.now(),i=0,o=399;case 4:if(!(o>=0)){t.next=21;break}u=0;case 6:if(!(u<800)){t.next=18;break}if(!p){t.next=9;break}return t.abrupt("return");case 9:if(g(u,o),(i=Date.now()-n)%100!==0){t.next=15;break}return r(m+i),t.next=15,C(function(){x(),k()});case 15:u+=e,t.next=6;break;case 18:o-=e,t.next=4;break;case 21:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),y=function(){var t=Object(i.a)(a.a.mark(function t(){var e,n,i,o,s,f,g,M,O;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=Date.now(),n=0,i=0,o=!0,s=!1,f=void 0,t.prev=6,g=u.render()[Symbol.iterator]();case 8:if(o=(M=g.next()).done){t.next=26;break}if(O=M.value,v[n]+=1,h[n]+=O,d[n]=c.data[n],c.data[n]=S(h[n]/v[n]),l[n]=c.data[n],n+=1,(i=Date.now()-e)%100!==0){t.next=21;break}return r(m+i),t.next=21,C(function(){x(),k()});case 21:if(!p){t.next=23;break}return t.abrupt("return");case 23:o=!0,t.next=8;break;case 26:t.next=32;break;case 28:t.prev=28,t.t0=t.catch(6),s=!0,f=t.t0;case 32:t.prev=32,t.prev=33,o||null==g.return||g.return();case 35:if(t.prev=35,!s){t.next=38;break}throw f;case 38:return t.finish(35);case 39:return t.finish(32);case 40:if(!p){t.next=42;break}return t.abrupt("return");case 42:x(),r(m+=Date.now()-e),(b+=1)>2?j():w=requestAnimationFrame(y);case 46:case"end":return t.stop()}},t,null,[[6,28,32,40],[33,,35,39]])}));return function(){return t.apply(this,arguments)}}(),j=function(){var t=Object(i.a)(a.a.mark(function t(){var e,n,i,o,u,c,s,f,h=arguments;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=h.length>0&&void 0!==h[0]?h[0]:0,n=L(d,l),i=Date.now(),o=0,u=0;case 5:if(!(u<2e4)){t.next=20;break}if(c=n[u],s=c.index%800,f=400-Math.floor(c.index/800),g(s,f),(o=Date.now()-i)%100!==0){t.next=15;break}return r(m+o),t.next=15,C(function(){x(),k()});case 15:if(!p){t.next=17;break}return t.abrupt("return");case 17:u++,t.next=5;break;case 20:if(!p){t.next=22;break}return t.abrupt("return");case 22:x(),r(m+=Date.now()-i),w=requestAnimationFrame(function(){e<5?j(e+1):y()});case 25:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return M(4).then(y),function(){p=!0,clearTimeout(w)}},[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("canvas",{width:800,height:400,ref:s,style:{background:"#000"}}),c.a.createElement("br",null),c.a.createElement("canvas",{width:800,height:400,ref:f}),c.a.createElement("h3",null,"\u5149\u7ebf\u8ffd\u8e2a\u65f6\u95f4\uff1a",(n/1e3).toFixed(2),"\u79d2"))}}}]);
//# sourceMappingURL=8.5c970351.chunk.js.map